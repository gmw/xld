/*
 *  filters.h
 *  XLDDSDDecoder
 *
 *  Created by tmkk on 14/05/12.
 *  Copyright 2014 tmkk. All rights reserved.
 *
 */

/*
 * The 2nd half (48 coeffs) of a 96-tap symmetric lowpass filter
 * from dsd2pcm
 *
 * Properties of this 96-tap lowpass filter when applied on a signal
 * with sampling rate of 44100*64 Hz:
 *
 * () has a delay of 17 microseconds.
 *
 * () flat response up to 48 kHz
 *
 * () if you downsample afterwards by a factor of 8, the
 *    spectrum below 70 kHz is practically alias-free.
 *
 * () stopband rejection is about 160 dB
 *
 * The coefficient tables ("ctables") take only 6 Kibi Bytes and
 * should fit into a modern processor's fast cache.
 */
static const double htaps_8to1[48] = {
	+9.950731974056657714e-02,+9.562845727714668065e-02,+8.819647126516944047e-02,+7.782552527068174741e-02,+6.534876523171298524e-02,+5.172629311427257015e-02,+3.794294849101870204e-02,+2.490921351762261093e-02,+1.337747462658970057e-02,+3.883043418804416145e-03,-3.284703416210725969e-03,-8.080250212687496714e-03,
	-1.067241812471033009e-02,-1.139427235000863015e-02,-1.068138779745870029e-02,-9.007905078766049317e-03,-6.828859761015334574e-03,-4.535184322001496043e-03,-2.425035959059578146e-03,-6.922187080790708326e-04,+5.700762133516592374e-04,+1.353838005269448076e-03,+1.713709169690936975e-03,+1.742046839472948102e-03,
	+1.545601648013235048e-03,+1.226696225277854957e-03,+8.704322683580221955e-04,+5.381636200535649473e-04,+2.664463454252759917e-04,+7.002968738383527972e-05,-5.279407053811266003e-05,-1.140625650874684021e-04,-1.304796361231894922e-04,-1.189970287491284975e-04,-9.396247155265073355e-05,-6.577634378272832012e-05,
	-4.074928958725350180e-05,-2.174079575545870077e-05,-9.163058931391722015e-06,-2.017460145032201133e-06,+1.249721855219005082e-06,+2.166655190537391817e-06,+1.930520892991081870e-06,+1.319400334374194979e-06,+7.410039764949090706e-07,+3.423230509967408957e-07,+1.244182214744588123e-07,+3.130441005359395694e-08,
};

/*
 * The 2nd half (112 coeffs) of a 224-tap symmetric lowpass filter
 *  - flat response up to ~35 kHz
 *  - alias free below ~35 kHz
 *  - stopband rejection ~-160 dB
 */

static double htaps_16to1[112]={
	+5.760462813961340911e-02, +5.691757911729226210e-02, +5.555982934698910219e-02, +5.356356970757100017e-02, +5.097584071644974124e-02, +4.785708826560070711e-02, +4.427932021228758730e-02, +4.032393001491144102e-02, +3.607926497084759654e-02, +3.163802486407806674e-02, +2.709458166634984982e-02, +2.254231220535396138e-02, +1.807103341873207009e-02, +1.376462411228964074e-02, +9.698908328714049912e-03, +5.939863928921530062e-03, 
	+2.542206329958864031e-03, -4.516178595725602886e-04, -3.012008656370503135e-03, -5.122359614640761838e-03, -6.778787301343743021e-03, -7.989471529052894969e-03, -8.773647602567644088e-03, -9.160302763993922320e-03, -9.186637450460090337e-03, -8.896357660427813702e-03, -8.337867548688329689e-03, -7.562431350066944717e-03, -6.622370993341054196e-03, -5.569360561977704585e-03, -4.452871427796344095e-03, -3.318812840644432948e-03, 
	-2.208402475303640131e-03, -1.157290413781186019e-03, -1.949487751238639024e-04, +6.556718097281456770e-04, +1.378228000447144063e-03, +1.962830183962950819e-03, +2.405675727112777888e-03, +2.708501415055656822e-03, +2.877891852193870201e-03, +2.924483152906128154e-03, +2.862101978458481914e-03, +2.706878996383537978e-03, +2.476373319315937002e-03, +2.188740653069128940e-03, +1.861973022276113086e-03, +1.513232339191010987e-03, 
	+1.158294059628507027e-03, +8.111110219952220434e-04, +4.835015649465252210e-04, +1.849604310259179106e-04, -7.741400027371707175e-05, -2.988867964233316867e-04, -4.769618051506617756e-04, -6.111814994833964041e-04, -7.028689690242875083e-04, -7.548301317186775859e-04, -7.710338230080065417e-04, -7.562862630242533132e-04, -7.159146274091129480e-04, -6.554722205113200752e-04, -5.804752203233431215e-04, -4.961782711053265614e-04, 
	-4.073935045445318940e-04, -3.183550094944409157e-04, -2.326284177570372112e-04, -1.530632418997455091e-04, -8.178395736251813184e-05, -2.021457860897648995e-05, +3.086935161782307266e-05, +7.126786445358902723e-05, +1.012693221865872058e-04, +1.215551028696340054e-04, +1.331019332169323043e-04, +1.370868574255101988e-04, +1.347989395314041930e-04, +1.275608199228540093e-04, +1.166622847621144983e-04, +1.033070589774495030e-04, 
	+8.857317092942181480e-05, +7.338651153573718159e-05, +5.850660458614138270e-05, +4.452313192296150120e-05, +3.186146077678470723e-05, +2.079524623147637055e-05, +1.146416398967912983e-05, +3.894913917889374591e-06, -1.976237783286506113e-06, -6.280878589462072164e-06, -9.197003076568571641e-06, -1.092962463456785992e-05, -1.169410169367897026e-05, -1.170252663016168039e-05, -1.115328413493569935e-05, -1.022369729486433082e-05, 
	-9.065501913715266297e-06, -7.802825857677858607e-06, -6.532217683647328614e-06, -5.324223752151299107e-06, -4.226118520432855354e-06, -3.265375069810791995e-06, -2.453390583768283789e-06, -1.789251932048668056e-06, -1.263325393243766064e-06, -8.603805222502517747e-07, -5.622136294265281904e-07, -3.498174364819740902e-07, -2.048713691800104068e-07, -1.108150375211134017e-07, -5.349252062858066909e-08, -2.369569955628185962e-08
};

/*
 * The 2nd half (288 coeffs) of a 576-tap symmetric lowpass filter
 *  - flat response up to ~20 kHz
 *  - alias free below ~25 kHz
 *  - stopband rejection ~-160 dB
 */

static const double htaps_32to1[288]={
	+2.832187306764930024e-02, +2.824254652547155894e-02, +2.808432323267462047e-02, +2.784805981693616941e-02, +2.753503385413587010e-02, +2.714693509532617108e-02, +2.668585387745912862e-02, +2.615426680982179883e-02, +2.555501984939613849e-02, +2.489130889836478969e-02, +2.416665807665070026e-02, +2.338489584045802885e-02, +2.255012913312142916e-02, +2.166671577126854861e-02, +2.073923528018081081e-02, +1.977245840528879875e-02, 
	+1.877131553484789883e-02, +1.774086427655622092e-02, +1.668625643570932973e-02, +1.561270464630398064e-02, +1.452544890578267960e-02, +1.342972326544866063e-02, +1.233072292235590922e-02, +1.123357195589693054e-02, +1.014329194292572060e-02, +9.064771677361208035e-03, +8.002738208179420443e-03, +6.961729398264351887e-03, +5.946068190188035993e-03, +4.959838752272686252e-03, +4.006864657703029797e-03, +3.090689234824688103e-03, 
	+2.214558204810868070e-03, +1.381404705106524956e-03, +5.938367750600997974e-04, -1.458726389730360105e-04, -8.357931251922676164e-04, -1.474341678431721064e-03, -2.060285011500399832e-03, -2.592739330986297986e-03, -3.071167626252056804e-03, -3.495374536995716000e-03, -3.865498885199498968e-03, -4.182003972794667845e-03, -4.445665765159678359e-03, -4.657559092152077987e-03, -4.819042016204004228e-03, -4.931738524717999700e-03, 
	-4.997519718506597715e-03, -5.018483673850830835e-03, -4.996934165225410361e-03, -4.935358439236965308e-03, -4.836404236456526978e-03, -4.702856256539406955e-03, -4.537612266426255953e-03, -4.343659045449917849e-03, -4.124048362213557709e-03, -3.881873170101666787e-03, -3.620244204366478060e-03, -3.342267154209461934e-03, -3.051020576317987898e-03, -2.749534703197336824e-03, -2.440771292077904830e-03, -2.127604643498118894e-03, 
	-1.812803909572205949e-03, -1.499016794767284036e-03, -1.188754739724831068e-03, -8.843796622609676611e-04, -5.880923159878271786e-04, -3.019223094748012953e-04, -2.771981672196853147e-05, +2.328510093090354054e-04, +4.783169194379940079e-04, +7.073987641151111699e-04, +9.190130312632209530e-04, +1.112271769238554978e-03, +1.286480949839729007e-03, +1.441137339257558998e-03, +1.575923953338351094e-03, +1.690704186375274927e-03, 
	+1.785514708046237074e-03, +1.860557233238480926e-03, +1.916189274480494973e-03, +1.952913992156397101e-03, +1.971369261884552831e-03, +1.972316081386773189e-03, +1.956626439645925940e-03, +1.925270773672532916e-03, +1.879305134991131072e-03, +1.819858188096574059e-03, +1.748118159472859074e-03, +1.665319851382668966e-03, +1.572731831126691080e-03, +1.471643899726622975e-03, +1.363354937798940932e-03, +1.249161220209139053e-03, 
	+1.130345281896554107e-03, +1.008165410318069988e-03, +8.838458312909389363e-04, +7.585676448036903982e-04, +6.334605606403685175e-04, +5.095954720021247247e-04, +3.879778977304505945e-04, +2.695423141347214925e-04, +1.551473879545594930e-04, +4.557211363254804956e-05, -5.848714982121302336e-05, -1.564187572764166965e-04, -2.476969904107944958e-04, -3.318824351965740140e-04, -4.086215575078230183e-04, -4.776455182147663035e-04, 
	-5.387682738310591891e-04, -5.918840138196919051e-04, -6.369639885152773850e-04, -6.740527876299678284e-04, -7.032641277165455583e-04, -7.247762138005570121e-04, -7.388267371729673530e-04, -7.457075750184377801e-04, -7.457592557458739410e-04, -7.393652541732076205e-04, -7.269461778585874657e-04, -7.089539070184127561e-04, -6.858657433614849096e-04, -6.581786260972080811e-04, -6.264034645490871179e-04, -5.910596374369238900e-04, 
	-5.526697023529318804e-04, -5.117543562206921647e-04, -4.688276814919214910e-04, -4.243927112239643780e-04, -3.789373367108787231e-04, -3.329305828153049135e-04, -2.868192651371369154e-04, -2.410250435838356953e-04, -1.959418791533248873e-04, -1.519338979503454109e-04, -1.093336609274202063e-04, -6.844083620403528401e-05, -2.952126273990103065e-05, +7.193603354780373285e-06, +4.150687831536549813e-05, +7.325609188926600346e-05, 
	+1.023127020047189011e-04, +1.285813056036018941e-04, +1.519985706393589032e-04, +1.725319145500247057e-04, +1.901779587762588038e-04, +2.049607845984900895e-04, +2.169300221144472075e-04, +2.261587990345685032e-04, +2.327415789478400943e-04, +2.367919175948391991e-04, +2.384401640618567114e-04, +2.378311335094294033e-04, +2.351217779434990897e-04, +2.304788767650866102e-04, +2.240767720798269929e-04, +2.160951675621174985e-04, 
	+2.067170101029857016e-04, +1.961264721050950878e-04, +1.845070473953395931e-04, +1.720397749429781933e-04, +1.589016006967123988e-04, +1.452638850724962988e-04, +1.312910642536376893e-04, +1.171394686019740960e-04, +1.029563003773818032e-04, +8.887877351093520658e-05, +7.503341100148990623e-05, +6.153550051153143063e-05, +4.848870165261734227e-05, +3.598480003610095225e-05, +2.410360151822594151e-05, +1.291295855053903023e-05, 
	+2.468918383889056018e-06, -7.184013145816823404e-06, -1.601250765005115149e-05, -2.399395521492089984e-05, -3.111592616541716165e-05, -3.737556186895185775e-05, -4.277890742838695083e-05, -4.734019621224070024e-05, -5.108109986524538059e-05, -5.402994956889200302e-05, -5.622094591580372044e-05, -5.769335894347278203e-05, -5.849073499133671775e-05, -5.866011315443717258e-05, -5.825126296545259699e-05, -5.731594732495138287e-05, 
	-5.590722103130646285e-05, -5.407876383363619297e-05, -5.188426189785901754e-05, -4.937683048908486720e-05, -4.660849167063507129e-05, -4.362970031161859664e-05, -4.048892644400089720e-05, -3.723228964006149269e-05, -3.390325110490128029e-05, -3.054235478313806212e-05, -2.718702770133251922e-05, -2.387142394326060915e-05, -2.062632445904036968e-05, -1.747907760208205116e-05, -1.445358715398980996e-05, -1.157033727646837037e-05, 
	-8.846458080574018455e-06, -6.295818680620189828e-06, -3.929157252171973044e-06, -1.754227570473739948e-06, +2.240237631741573941e-07, +2.003269670958403207e-06, +3.583595178404888061e-06, +4.967283563592720253e-06, +6.158591065304208374e-06, +7.163523781438434288e-06, +7.989605153551517631e-06, +8.645655922021059845e-06, +9.141567487947644549e-06, +9.488091562562559833e-06, +9.696631517220285660e-06, +9.779049329335696517e-06, 
	+9.747480310794938088e-06, +9.614167244464591190e-06, +9.391299843338294523e-06, +9.090880843396395889e-06, +8.724594355736636002e-06, +8.303701327506392776e-06, +7.838941789073578681e-06, +7.340457950486000819e-06, +6.817728374480834957e-06, +6.279521753606318258e-06, +5.733855923492686614e-06, +5.187982122765973032e-06, +4.648366564206547802e-06, +4.120696806411627361e-06, +3.609887898458663985e-06, +3.120103103878763992e-06, 
	+2.654779859917369158e-06, +2.216665275032597026e-06, +1.807850545720459064e-06, +1.429821746494539930e-06, +1.083498450311866066e-06, +7.692908715604939946e-07, +4.871471467434027954e-07, +2.366065597327929097e-07, +1.685298747544682079e-08, -1.732343427836944947e-07, -3.350338561481026136e-07, -4.701273358362828907e-07, -5.802636066524420439e-07, -6.673070867471868495e-07, -7.332020304139356636e-07, -7.799366405940304219e-07, 
	-8.095047672834952274e-07, -8.238824329747376403e-07, -8.250008741034842748e-07, -8.147207590728109846e-07, -7.948230056574863639e-07, -7.669837851706851544e-07, -7.327663071654264482e-07, -6.936164634597962917e-07, -6.508435222985967835e-07, -6.056342016160503943e-07, -5.590400950831992114e-07, -5.119819580367899411e-07, -4.652602101145172060e-07, -4.195480307943062800e-07, -3.753998202582935077e-07, -3.332724301320836108e-07, 
	-2.934992650879649092e-07, -2.563468124086172886e-07, -2.219805813833762934e-07, -1.904989412997169059e-07, -1.619409995434067118e-07, -1.362810288919094114e-07, -1.134353071512805988e-07, -9.332323773092096349e-08, -7.575343334062521977e-08, -6.062291042937457074e-08, -4.771030411192680066e-08, -3.683224038816808700e-08, -2.779864972391978905e-08, -2.040794120555675876e-08, -1.445169688628993990e-08, -1.699951695670444848e-08
};
